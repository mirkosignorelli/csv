Code used in the simulations described in Section 4
